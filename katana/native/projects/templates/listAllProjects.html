{% load static %}
{% load jsonify %}


<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="{% static './jquery-ui-1.12.1.custom/jquery-ui.css' %}">
<link rel="stylesheet" href="{% static './table.css' %}">

<script type="text/javascript" src="{% static "./badgerfish.js" %}"></script>
<script type="text/javascript" src="{% static "./json.js" %}"></script>
<script type="text/javascript" src="{% static "./xmlparser.js" %}"></script>
<script type="text/javascript" src="{% static "./doProjectHandling.js" %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/jstree.min.js"></script>

    <h2>List of Projects</h2>
	{% for xx in listOfFiles %}
		<table>
		<tr><td>
		<div class="linkToProject" href="./projects/editProject/?fname={{xx}}" fname="{{xx}}">{{xx}}</div>
		</td></tr>
		</table>
	{% endfor %}
	<br>

<div id="myProject">
</div>


<div id="myProjectTree">
</div>


<script> 
/*
	$('#myProjectTree').jstree({ 'core' : {
    'data' : [
       'Simple root node',
       {
         'text' : 'Root node 2',
         'state' : {
           'opened' : true,
           'selected' : true
         },
         'children' : [
           { 'text' : 'Child 1' },
           'Child 2'
         ]
      }
    ]
	} });
*/

$(".linkToProject").click(function() { 

	var $elem = $(this);

	var thePage = $elem.attr('href');
	var theID   = $elem.attr('fname');

	/*
	katana.$activeTab.find('#myProject').load(thePage, function(response) { 
		jsonProjectID = theID;    //ke this an ID 
		console.log("my ID = " + jsonProjectID);
		//jsonAllProjectPages[jsonProjectID] =  {{fulljson|jsonify}};
		//console.log("my data = " +jsonAllProjectPages[jsonProjectID]);
		//jsonProjectObject =  jsonAllProjectPages[jsonProjectID];
		//mapFullProjectJson(jsonProjectObject);
		mapFullProjectJson(jsonProjectID);	
	});
    */
    // instead of on
    katana.$view.one('tabAdded', function(){
   		mapFullProjectJson(theID);
    });
	//
	katana.templateAPI.load( thePage, null, null, 'title') ;
	//alert(katana.$activeTab) ;





});
</script>

